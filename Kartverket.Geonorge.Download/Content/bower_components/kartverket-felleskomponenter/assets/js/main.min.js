function showLoadingAnimation(t){$("#loading-animation").html(t),$("#loading-animation").show()}function hideLoadingAnimation(){$("#loading-animation").html(""),$("#loading-animation").hide()}function notOpeningInNewTab(t){return!(t.ctrlKey||t.shiftKey||t.metaKey||t.button&&1==t.button)}function addDefaultLoadingAnimation(t){t.addClass("show-loading-animation"),t.data("loading-message","Henter innhold")}function addShoppingCartTooltip(t){var e=$("#shopping-cart-url"),a=0!==t?t:"ingen",o=1==t?"Du har "+a+" nedlasting i kurven din":"Du har "+a+" nedlastinger i kurven din";e.attr("title",o),e.attr("data-original-title",o),e.data("toggle","tooltip"),e.data("placement","bottom"),e.tooltip()}function updateShoppingCart(){var t=$("#orderitem-count"),e="",a={},o="orderitems",n=0,i=".geonorge.no";null!==localStorage.getItem("orderItems")&&"[]"!=localStorage.getItem("orderItems")&&(e=localStorage.getItem("orderItems")),""!==e?(t.css("display","block"),a=JSON.parse(e),n=a.length,t.html(n),addShoppingCartTooltip(n)):void 0!==Cookies.get(o)&&0!==Cookies.get(o)&&"0"!==Cookies.get(o)?(n=Cookies.get(o),t.css("display","block"),t.html(n),addShoppingCartTooltip(n)):(t.css("display","none"),addShoppingCartTooltip(0)),Cookies.set(o,n,{expires:7,path:"/",domain:i})}function updateShoppingCartCookie(){var t=$("#orderitem-count"),e="orderitems",a=".geonorge.no",o=0;if(null!==localStorage.getItem("orderItems")&&"[]"!=localStorage.getItem("orderItems")){var n=localStorage.getItem("orderItems"),i=JSON.parse(n);o=i.length,t.html(o),addShoppingCartTooltip(o)}else o=0,t.css("display","none"),addShoppingCartTooltip(o);Cookies.set(e,o,{expires:7,path:"/",domain:a})}function updateToggleLinks(t){$(t).each(function(){$(this).toggleClass("show-content")})}function activateTab(t){$(".link-tabs").ready(function(){tabLink=$(".link-tabs li a[data-tab='"+t+"']"),$(".link-tabs li.active").removeClass("active"),tabLink.parent("li").addClass("active")})}function updateAllCartButtons(t){$(".add-to-cart-btn").each(function(){var e=$(this).attr("itemuuid");$.inArray(e,t)>-1&&($(this).addClass("added"),$(this).attr("title","Allerede lagt til i kurv"),$(this).children(".button-text").text(" Lagt i kurv"))})}function updateCartButton(t){var e=$(t).attr("itemuuid");$('.add-to-cart-btn[itemuuid="'+e+'"]').each(function(){$(this).addClass("added"),$(this).attr("data-original-title","Allerede lagt til i kurv"),$(this).children(".button-text").text(" Lagt i kurv")})}function notCurrentUrl(t){return t==window.location.href||t==window.location.pathname||(t==window.location.href+"/"||t==window.location.pathname+"/"||void 0)}function disableLastBreadcrumb(){if($("ul.breadcrumbs li").last().has("a").length){var t=$("ul.breadcrumbs li").last().text();$("ul.breadcrumbs li").last().html(t)}}var applicationEnvironment=void 0===applicationEnvironment?"":applicationEnvironment,applicationVersionNumber=void 0===applicationVersionNumber?"":applicationVersionNumber,supportsLogin=!1,authenticationData=void 0===authenticationData?{}:authenticationData;authenticationData!=={}&&(supportsLogin=void 0!==authenticationData.supportsLogin&&authenticationData.supportsLogin,authenticationData.isAuthenticated=void 0!==authenticationData.isAuthenticated&&authenticationData.isAuthenticated,authenticationData.urlActionSignIn=void 0===authenticationData.urlActionSignIn?"":authenticationData.urlActionSignIn,authenticationData.urlActionSignOut=void 0===authenticationData.urlActionSignOut?"":authenticationData.urlActionSignOut,authenticationData.userName=void 0===authenticationData.userName?"":authenticationData.userName);var geonorgeUrl=""===applicationEnvironment?"https://www.geonorge.no/":"https://www.test.geonorge.no/";showLoadingAnimation("Laster innhold"),$(document).ready(function(){hideLoadingAnimation(),$(document).on("click",".show-loading-animation",function(t){if(notOpeningInNewTab(t)){var e=void 0!==$(this).data("loading-message")?$(this).data("loading-message"):"";showLoadingAnimation(e)}}),$("#geonorge-logo").length&&($("#geonorge-logo a").prop("href",geonorgeUrl),$("#geonorge-logo a img").prop("src","/Content/bower_components/kartverket-felleskomponenter/assets/images/svg/geonorge_"+applicationEnvironment+"logo.svg")),$("#applicationVersionNumber").length&&""!==applicationVersionNumber&&$("#applicationVersionNumber").html("Versjon "+applicationVersionNumber);var t="https://kartkatalog.geonorge.no/Download";""!==applicationEnvironment&&(t="https://kartkatalog."+applicationEnvironment+".geonorge.no/Download"),$("#shopping-cart-url").prop("href",t),supportsLogin&&$("#container-login").length&&($("#container-login").append("<ul></ul>"),$("#container-login ul").append("<li><a href='"+geonorgeUrl+"kartdata/oppslagsverk/Brukernavn-og-passord/'>Ny bruker</a></li>"),authenticationData.isAuthenticated?$("#container-login ul").append("<li id='login'><a href='"+authenticationData.urlActionSignOut+"' class='geonorge-aut' title='Logg ut "+authenticationData.userName+"'> Logg ut</a></li>"):$("#container-login ul").append("<li id='login'><a href='"+authenticationData.urlActionSignIn+"' class='geonorge-aut'> Logg inn</a></li>"))}),$(window).load(function(){var t={disable_search_threshold:10,search_contains:!0};$(".chosen-select").chosen(t),$("[data-toggle='tooltip']").tooltip(),$("li.has-error[data-toggle='tooltip']").tooltip("option","position",{my:"center",at:"center bottom+30"}),$("li[data-toggle='tooltip']").mouseleave(function(){$(".ui-helper-hidden-accessible").remove()}),$(".ui-tooltip-element[data-toggle='tooltip']").tooltip("option","position",{my:"center",at:"center bottom+25"}),$(".ui-tooltip-element[data-toggle='tooltip']").mouseleave(function(){$(".ui-helper-hidden-accessible").remove()});var e=document.documentElement;e.setAttribute("data-useragent",navigator.userAgent)}),angular.module("geonorge",["ui.bootstrap"]),angular.module("geonorge").config(["$sceDelegateProvider",function(t){t.resourceUrlWhitelist(["**"])}]);var searchOptionsArray={dev:{text:"Kartkatalogen",searchTitle:"Kartkatalogen",buttonCss:"edgesKartkatalogen",listCss:"left-edge-kartkatalogen",baseUrl:"//kartkatalog.dev.geonorge.no",url:"//kartkatalog.dev.geonorge.no/search",api:"//kartkatalog.dev.geonorge.no/api/search",queryParameter:"?text=",localUrl:!1,autoComplete:!0,geonorgeUrl:"//www.test.geonorge.no"},test:{text:"Kartkatalogen",searchTitle:"Kartkatalogen",buttonCss:"edgesKartkatalogen",listCss:"left-edge-kartkatalogen",baseUrl:"//kartkatalog.test.geonorge.no",url:"//kartkatalog.test.geonorge.no/search",api:"//kartkatalog.test.geonorge.no/api/search",queryParameter:"?text=",localUrl:!1,autoComplete:!0,geonorgeUrl:"//www.test.geonorge.no"},prod:{text:"Kartkatalogen",searchTitle:"Kartkatalogen",buttonCss:"edgesKartkatalogen",listCss:"left-edge-kartkatalogen",baseUrl:"//kartkatalog.geonorge.no",url:"//kartkatalog.geonorge.no/search",api:"//kartkatalog.geonorge.no/api/search",queryParameter:"?text=",localUrl:!1,autoComplete:!0,geonorgeUrl:"//www.geonorge.no"}},searchOption=searchOptionsArray.prod;if(""!==applicationEnvironment&&null!==applicationEnvironment)var searchOption=searchOptionsArray[applicationEnvironment];var baseurl_local=searchOption.baseUrl;!function(){var t=angular.module("geonorge");t.service("aggregatedService",["$http","$q",function(t,e){function a(t){l=t}function o(t){return e(function(e){void 0===l?e():l(t)})}function n(a,o,n,i){function r(t,e){var a="facets[1]name=type&facets[1]value="+t,o="text="+e;return"?limit=5&"+a+"&"+o}var l=encodeURI(searchOption.api+"?limit=5&facets[1]name=type&facets[1]value=dataset&text="+a),s=t({method:"GET",url:l,headers:{"Content-Type":"application/json; charset=utf-8",accept:"*/*"},data:{}}),c=encodeURI(searchOption.api+r("servicelayer",a)),u=t({method:"GET",url:c,headers:{"Content-Type":"application/json; charset=utf-8",accept:"*/*"},data:{}}),g=encodeURI(searchOption.api+r("service",a)),d=t({method:"GET",url:g,headers:{"Content-Type":"application/json; charset=utf-8",accept:"*/*"},data:{}}),p=encodeURI(searchOption.api+r("dimensionGroup",a)),h=t({method:"GET",url:p,headers:{"Content-Type":"application/json; charset=utf-8",accept:"*/*"},data:{}});return e.all([h,s,d,u])}var i=document.getElementById("txtLang"),r="";i&&(r=i.value);var l=void 0;return{triggerSearch:o,executeMethod:a,performSearch:n}}]).controller("searchTopController",["$rootScope","$scope","$location","$window","$timeout","aggregatedService","$sce",function(t,e,a,o,n,i,r){function l(){var a=e.selectedSearch,n="";""!==t.searchQuery&&(n=a.queryParameter,n+=t.searchQuery);var i=a.url+n;o.location.href=i}function s(t){if(e.ajaxCallActive=!1,e.autoCompleteResult=[],t.d){var a=[];if(0===t.d.NumberOfHitsTotal)return void(e.autoCompleteResult=[]);a=t.d.Results;for(var o=0;o<a.length;o++){var n={},i=a[o];if(0!==i.data.Results.length){n.type=i.Section,n.title=i.SectionName,n.list=[];for(var r=0;r<i.data.Results.length;r++){var l=i.data.Results[r];n.title=c(l.Type),n.url=searchOption.url,n.list.push({externalId:i.SectionName+"_"+i.Section+"_"+r,id:r,typeId:i.Section,title:l.Title,url:l.ShowDetailsUrl})}e.autoCompleteResult.push(n),console.log(n)}}}}function c(t){switch(t){case"dataset":return"Datasett";case"servicelayer":return"Tjenestelag";case"service":return"Tjenester";case"dimensionGroup":return"Datapakker"}}function u(){k>0&&1==v&&(k--,0===k&&(v=null)),1==k&&v>1&&(v--,k=e.autoCompleteResult[v-1].list.length),v>1&k>1&&k--,d()}function g(){null===v?(v=1,k=1):(v==e.autoCompleteResult.length&&e.autoCompleteResult[v-1].list.length>k&&k++,v<e.autoCompleteResult.length&&(e.autoCompleteResult[v-1].list.length>k?k++:(v++,k=1))),d()}function d(){for(var t=0;t<e.autoCompleteResult.length;t++){var a=e.autoCompleteResult[t];if(t==v-1)for(var o=0;o<a.list.length;o++){var n=a.list[o];o==k-1?n.highlight=!0:n.highlight=!1}else for(var i=0;i<a.list.length;i++)a.list[i].highlight=!1}console.log("categoryCount "+v),console.log("resultCount "+k)}t.trustHtml=function(t){return r.trustAsHtml(t)},e.dropdownOpen=!1,e.extendedSearchOpen=!1,e.showFakeResults=!1,e.searchString="",t.selectedSearch=searchOption,t.searchQuery=parseLocation(window.location.search).text,e.autoCompleteResult=[],e.autoCompletePartial="/Content/bower_components/kartverket-felleskomponenter/assets/partials/_autoCompleteRow.html",e.focused=!1,e.autocompleteActive=!1,e.ajaxCallActive=!1,e.allowBlur=!0,e.viewport={width:window.innerWidth,height:window.innerHeight},e.breakpoints={xSmall:480,small:768,medium:992,large:1200};var p=function(a,o){a.preventDefault(),a.stopPropagation(),t.selectedSearch=o,e.dropdownOpen=!1;var n=document.getElementById("txtSearch");n.focus()};e.select=p;var h=function(t){var e;switch(t.keyCode){case 38:t.target.blur(),e=angular.element(t.target).next(),e.children()[dropdownOptions.length-1].focus();break;case 40:t.target.blur(),e=angular.element(t.target).next(),e.children()[0].focus();break;default:return}t.preventDefault(),t.stopPropagation()},m=function(t,e){var a;switch(t.keyCode){case 13:return void p(t,dropdownOptions[e]);case 38:var o=angular.element(document.getElementById("search-dropdown"));a=0===e?o.children()[dropdownOptions.length-1]:o.children()[e-1];break;case 40:a=e>=dropdownOptions.length-1?angular.element(document.getElementById("search-dropdown")).children()[0]:angular.element(t.target).next()[0];break;default:return}t.target.blur(),a.focus(),t.preventDefault(),t.stopPropagation()};e.dropdownKeyDown=m,e.buttonDropdownKeyDown=h,e.onSearch=function(e){if(e&&e.preventDefault(),!(t.searchQuery.length<3)){var a=i.triggerSearch(t.searchQuery);a.then(l)}},e.preventDefault=function(t){switch(t.keyCode){case 13:t.preventDefault();break;case 16:$=!0;break;case 9:e.autoCompleteResult.length>0&&t.preventDefault();break;case 38:case 40:t.preventDefault()}};var f=null;e.autocomplete=function(a){if(e.focused!==!1){if(t.searchQuery.length<3)return e.autoCompleteResult=[],e.autocompleteActive=!1,e.ajaxCallActive=!1,void(v=null);switch(a.keyCode){case 13:null===v?(e.resetAutocomplete(),e.allowBlur=!0,e.onSearch(a)):(e.allowBlur=!1,window.location=e.autoCompleteResult[v-1].list[k-1].url);break;case 16:$=!1;break;case 37:break;case 38:return u(),!1;case 39:break;case 9:$?u():g();break;case 40:return g(),!1;default:return v=null,f&&(n.cancel(f),f=null,console.log("cancel timeout")),void(f=n(function(){e.autocompleteActive=!0,console.log("calling WS"),t.searchQuery.length>0&&(e.ajaxCallActive=!0,i.performSearch(t.searchQuery,[],5,0).then(function(t){console.log(t);var e={d:{Results:t}};s(e)}))},300))}}};var v=null,k=null,$=!1;e.mouseOver=function(t,a,o){console.log(a),console.log(o),e.allowBlur=t,k=o+1,v=a+1,d()},e.mouseOut=function(t){e.allowBlur=t},e.resetAutocomplete=function(){e.focused=!1,e.autocompleteActive=!1,e.ajaxCallActive=!1,e.autoCompleteResult=[]},e.setFocus=function(t){e.focused=!0,console.log(e.focused),angular.element(t.target).on("blur",function(){n(function(){e.allowBlur&&(e.resetAutocomplete(),console.log(e.focused),angular.element(t.target).on("blur",null))},!0)})},angular.element(document).ready(function(){i.triggerSearch(t.searchQuery)})}])}();var parseLocation=function(t){var e,a,o=t.substring(1).split("&"),n={};for(a in o)""!==o[a]&&(e=o[a].split("="),n[decodeURIComponent(e[0])]=decodeURIComponent(e[1]));return n},baseurl="http://"+window.location.host;$(document).ready(function(){$(".page-wizard .page-wizard-tab").on("click",function(){$(".page-wizard").toggleClass("open")});var t=$("<li class='jose'><ul></ul></li>");$("<p>te</p>").appendTo($(t).find("ul"))}),function(){var t=angular.module("geonorge"),e=searchOption.geonorgeUrl;t.controller("menuTopController",["$scope","$http",function(t,a){function o(e){localStorage.setItem("menuItems",JSON.stringify(e));var a=new Date,o=3;a.setTime(a.getTime()+60*o*1e3),Cookies.set("expire","menu",{expires:a}),t.menuItems=e.data}function n(){t.getMenuError=!0}t.getMenuData=function(){if(!Cookies.get("expire")||!localStorage.getItem("menuItems")){var i=e+"/api/menu",r=a({method:"GET",url:i,headers:{"Content-Type":"application/json; charset=utf-8"},data:{}});return console.log("Menu loaded from server"),r.then(o,n)}console.log("Menu loaded locally"),response=JSON.parse(localStorage.getItem("menuItems")),t.menuItems=response.data}}])}(),$(window).load(function(){updateShoppingCart()}),$("document").ready(function(){updateToggleLinks($(".toggle-content")),$(".toggle-content").click(function(){var t=$(this).data("content-toggle");updateToggleLinks($(this)),$("."+t).toggle()})}),$(".link-tabs").ready(function(){$(".link-tabs li a").click(function(t){t.preventDefault(),activateTab($(this).data("tab")),$("#tab-content").css("opacity",".15"),window.location.href=$(this).prop("href")})}),$("document").ready(function(){$("a.help-text-toggle").click(function(t){t.preventDefault();var e=$(this),a=$(this).data("help-text-id");$("#"+a).toggle(),$("#"+a).hasClass("active")?($("#"+a).removeClass("active"),e.removeClass("active")):($("#"+a).addClass("active"),e.addClass("active"))})}),$("document").ready(function(){$("ul.pagination a, ul.breadcrumbs a").each(function(){$(this).closest("li").hasClass("active")||addDefaultLoadingAnimation($(this))})}),$("document").ready(function(){$("body").on("click","a",function(){notCurrentUrl($(this).attr("href"))&&$(this).removeClass("show-loading-animation")})}),$("document").ready(function(){disableLastBreadcrumb()});