function showLoadingAnimation(t){$("#loading-animation").html(t),$("#loading-animation").show()}function hideLoadingAnimation(){$("#loading-animation").html(""),$("#loading-animation").hide()}function notOpeningInNewTab(t){return!(t.ctrlKey||t.shiftKey||t.metaKey||t.button&&1==t.button)}function addDefaultLoadingAnimation(t){t.addClass("show-loading-animation"),t.data("loading-message","Henter innhold")}function addShoppingCartTooltip(t){var e=$("#shopping-cart-url"),a=0!==t?t:"ingen",o=1==t?"Du har "+a+" nedlasting i kurven din":"Du har "+a+" nedlastinger i kurven din";e.attr("title",o),e.attr("data-original-title",o),e.data("toggle","tooltip"),e.data("placement","bottom"),e.tooltip()}function updateShoppingCart(){var t=$("#orderitem-count"),e="",a=0;null!==localStorage.getItem("orderItems")&&"[]"!=localStorage.getItem("orderItems")&&(e=localStorage.getItem("orderItems")),""!==e?(t.css("display","block"),a=JSON.parse(e).length,t.html(a),addShoppingCartTooltip(a)):void 0!==Cookies.get("orderitems")&&0!==Cookies.get("orderitems")&&"0"!==Cookies.get("orderitems")?(a=Cookies.get("orderitems"),t.css("display","block"),t.html(a),addShoppingCartTooltip(a)):(t.css("display","none"),addShoppingCartTooltip(0)),Cookies.set("orderitems",a,{expires:7,path:"/",domain:".geonorge.no"})}function updateShoppingCartCookie(){var t=$("#orderitem-count"),e=0;if(null!==localStorage.getItem("orderItems")&&"[]"!=localStorage.getItem("orderItems")){var a=localStorage.getItem("orderItems");e=JSON.parse(a).length,t.html(e),addShoppingCartTooltip(e)}else e=0,t.css("display","none"),addShoppingCartTooltip(e);Cookies.set("orderitems",e,{expires:7,path:"/",domain:".geonorge.no"})}function updateToggleLinks(t){$(t).each(function(){$(this).toggleClass("show-content")})}function activateTab(t){$(".link-tabs").ready(function(){tabLink=$(".link-tabs li a[data-tab='"+t+"']"),$(".link-tabs li.active").removeClass("active"),tabLink.parent("li").addClass("active")})}function updateAllCartButtons(t){$(".add-to-cart-btn").each(function(){var e=$(this).attr("itemuuid");$.inArray(e,t)>-1&&($(this).addClass("added"),$(this).attr("title","Allerede lagt til i kurv"),$(this).children(".button-text").text(" Lagt i kurv"))})}function updateCartButton(t,e){var a=$(t).attr("itemuuid");$.inArray(a,e)>-1?$('.add-to-cart-btn[itemuuid="'+a+'"]').each(function(){var t=void 0!==$(this).attr("itemname")?" "+$(this).attr("itemname")+" ":"";$(this).addClass("added"),$(this).attr("data-original-title","Fjern"+t+"fra kurv"),$(this).children(".button-text").text(" Fjern fra kurv")}):$('.add-to-cart-btn[itemuuid="'+a+'"]').each(function(){var t=void 0!==$(this).attr("itemname")?" "+$(this).attr("itemname")+" ":"";$(this).removeClass("added"),$(this).attr("data-original-title","Legg til"+t+"i kurv"),$(this).children(".button-text").text(" Legg i kurv")})}function notCurrentUrl(t){return t==window.location.href||t==window.location.pathname||(t==window.location.href+"/"||t==window.location.pathname+"/"||void 0)}function disableLastBreadcrumb(){if($("ul.breadcrumbs li").last().has("a").length){var t=$("ul.breadcrumbs li").last().text();$("ul.breadcrumbs li").last().html(t)}}function showAlert(t,e){$("#feedback-alert").attr("class","alert alert-dismissible alert-"+e),$("#feedback-alert .message").html($("#feedback-alert .message").html()+t+"<br/>"),$("#feedback-alert").show()}function clearAlertMessage(){$("#feedback-alert .message").html("")}function hideAlert(){$("#feedback-alert").hide()}var applicationEnvironment=void 0===applicationEnvironment?"":applicationEnvironment,applicationVersionNumber=void 0===applicationVersionNumber?"":applicationVersionNumber,supportsLogin=!1,authenticationData=void 0===authenticationData?{}:authenticationData;authenticationData!=={}&&(supportsLogin=void 0!==authenticationData.supportsLogin&&authenticationData.supportsLogin,authenticationData.isAuthenticated=void 0!==authenticationData.isAuthenticated&&authenticationData.isAuthenticated,authenticationData.urlActionSignIn=void 0===authenticationData.urlActionSignIn?"":authenticationData.urlActionSignIn,authenticationData.urlActionSignOut=void 0===authenticationData.urlActionSignOut?"":authenticationData.urlActionSignOut,authenticationData.userName=void 0===authenticationData.userName?"":authenticationData.userName);var geonorgeUrl=""===applicationEnvironment?"https://www.geonorge.no/":"https://www.test.geonorge.no/";showLoadingAnimation("Laster innhold"),$(document).ready(function(){hideLoadingAnimation(),$(document).on("click",".show-loading-animation",function(t){notOpeningInNewTab(t)&&showLoadingAnimation(void 0!==$(this).data("loading-message")?$(this).data("loading-message"):"")}),$("#geonorge-logo").length&&($("#geonorge-logo a").prop("href",geonorgeUrl),$("#geonorge-logo a img").prop("src","/Content/bower_components/kartverket-felleskomponenter/assets/images/svg/geonorge_"+applicationEnvironment+"logo.svg")),$("#applicationVersionNumber").length&&""!==applicationVersionNumber&&$("#applicationVersionNumber").html("Versjon "+applicationVersionNumber);var t="https://kartkatalog.geonorge.no/Download";""!==applicationEnvironment&&(t="https://kartkatalog."+applicationEnvironment+".geonorge.no/Download"),$("#shopping-cart-url").prop("href",t),supportsLogin&&$("#container-login").length&&($("#container-login").append("<ul></ul>"),$("#container-login ul").append("<li><a href='"+geonorgeUrl+"kartdata/oppslagsverk/Brukernavn-og-passord/'>Ny bruker</a></li>"),authenticationData.isAuthenticated?$("#container-login ul").append("<li id='login'><a href='"+authenticationData.urlActionSignOut+"' class='geonorge-aut' title='Logg ut "+authenticationData.userName+"'> Logg ut</a></li>"):$("#container-login ul").append("<li id='login'><a href='"+authenticationData.urlActionSignIn+"' class='geonorge-aut'> Logg inn</a></li>"))}),$(window).load(function(){var t={disable_search_threshold:10,search_contains:!0};$(".chosen-select").chosen(t),$("[data-toggle='tooltip']").tooltip({trigger:"hover"}),$("li.has-error[data-toggle='tooltip']").tooltip("option","position",{my:"center",at:"center bottom+30"}),$("li[data-toggle='tooltip']").mouseleave(function(){$(".ui-helper-hidden-accessible").remove()}),$(".ui-tooltip-element[data-toggle='tooltip']").tooltip("option","position",{my:"center",at:"center bottom+25"}),$(".ui-tooltip-element[data-toggle='tooltip']").mouseleave(function(){$(".ui-helper-hidden-accessible").remove()}),document.documentElement.setAttribute("data-useragent",navigator.userAgent)}),angular.module("geonorge",["ui.bootstrap"]),angular.module("geonorge").config(["$sceDelegateProvider",function(t){t.resourceUrlWhitelist(["**"])}]);var searchOptionsArray={dev:{text:"Kartkatalogen",searchTitle:"Kartkatalogen",buttonCss:"edgesKartkatalogen",listCss:"left-edge-kartkatalogen",baseUrl:"//kartkatalog.dev.geonorge.no",url:"//kartkatalog.dev.geonorge.no/search",api:"//kartkatalog.dev.geonorge.no/api/search",queryParameter:"?text=",localUrl:!1,autoComplete:!0,geonorgeUrl:"//www.test.geonorge.no"},test:{text:"Kartkatalogen",searchTitle:"Kartkatalogen",buttonCss:"edgesKartkatalogen",listCss:"left-edge-kartkatalogen",baseUrl:"//kartkatalog.test.geonorge.no",url:"//kartkatalog.test.geonorge.no/search",api:"//kartkatalog.test.geonorge.no/api/search",queryParameter:"?text=",localUrl:!1,autoComplete:!0,geonorgeUrl:"//www.test.geonorge.no"},prod:{text:"Kartkatalogen",searchTitle:"Kartkatalogen",buttonCss:"edgesKartkatalogen",listCss:"left-edge-kartkatalogen",baseUrl:"//kartkatalog.geonorge.no",url:"//kartkatalog.geonorge.no/search",api:"//kartkatalog.geonorge.no/api/search",queryParameter:"?text=",localUrl:!1,autoComplete:!0,geonorgeUrl:"//www.geonorge.no"}},searchOption=searchOptionsArray.prod;if(""!==applicationEnvironment&&null!==applicationEnvironment)var searchOption=searchOptionsArray[applicationEnvironment];var baseurl_local=searchOption.baseUrl;!function(){angular.module("geonorge").service("aggregatedService",["$http","$q",function(t,e){function a(t){r=t}function o(t){return e(function(e){void 0===r?e():r(t)})}function n(a,o,n,i){function r(t,e){return"?limit=5&"+("facets[1]name=type&facets[1]value="+t)+"&"+("text="+e)}var l=encodeURI(searchOption.api+"?limit=5&facets[1]name=type&facets[1]value=dataset&text="+a),s=t({method:"GET",url:l,headers:{"Content-Type":"application/json; charset=utf-8",accept:"*/*"},data:{}}),c=encodeURI(searchOption.api+r("servicelayer",a)),u=t({method:"GET",url:c,headers:{"Content-Type":"application/json; charset=utf-8",accept:"*/*"},data:{}}),d=encodeURI(searchOption.api+r("service",a)),g=t({method:"GET",url:d,headers:{"Content-Type":"application/json; charset=utf-8",accept:"*/*"},data:{}}),p=encodeURI(searchOption.api+r("dimensionGroup",a)),h=t({method:"GET",url:p,headers:{"Content-Type":"application/json; charset=utf-8",accept:"*/*"},data:{}});return e.all([h,s,g,u])}var i=document.getElementById("txtLang");i&&i.value;var r=void 0;return{triggerSearch:o,executeMethod:a,performSearch:n}}]).controller("searchTopController",["$rootScope","$scope","$location","$window","$timeout","aggregatedService","$sce",function(t,e,a,o,n,i,r){function l(){var a=e.selectedSearch,n="";""!==t.searchQuery&&(n=a.queryParameter,n+=t.searchQuery);var i=a.url+n;o.location.href=i}function s(t){if(e.ajaxCallActive=!1,e.autoCompleteResult=[],t.d){var a=[];if(0===t.d.NumberOfHitsTotal)return void(e.autoCompleteResult=[]);a=t.d.Results;for(var o=0;o<a.length;o++){var n={},i=a[o];if(0!==i.data.Results.length){n.type=i.Section,n.title=i.SectionName,n.list=[];for(var r=0;r<i.data.Results.length;r++){var l=i.data.Results[r];n.title=c(l.Type),n.url=searchOption.url,n.list.push({externalId:i.SectionName+"_"+i.Section+"_"+r,id:r,typeId:i.Section,title:l.Title,url:l.ShowDetailsUrl})}e.autoCompleteResult.push(n),console.log(n)}}}}function c(t){switch(t){case"dataset":return"Datasett";case"servicelayer":return"Tjenestelag";case"service":return"Tjenester";case"dimensionGroup":return"Datapakker"}}function u(){$>0&&1==v&&0===--$&&(v=null),1==$&&v>1&&(v--,$=e.autoCompleteResult[v-1].list.length),v>1&$>1&&$--,g()}function d(){null===v?(v=1,$=1):(v==e.autoCompleteResult.length&&e.autoCompleteResult[v-1].list.length>$&&$++,v<e.autoCompleteResult.length&&(e.autoCompleteResult[v-1].list.length>$?$++:(v++,$=1))),g()}function g(){for(var t=0;t<e.autoCompleteResult.length;t++){var a=e.autoCompleteResult[t];if(t==v-1)for(var o=0;o<a.list.length;o++){var n=a.list[o];n.highlight=o==$-1}else for(var i=0;i<a.list.length;i++)a.list[i].highlight=!1}console.log("categoryCount "+v),console.log("resultCount "+$)}t.trustHtml=function(t){return r.trustAsHtml(t)},e.dropdownOpen=!1,e.extendedSearchOpen=!1,e.showFakeResults=!1,e.searchString="",t.selectedSearch=searchOption,t.searchQuery=parseLocation(window.location.search).text,e.autoCompleteResult=[],e.autoCompletePartial="/Content/bower_components/kartverket-felleskomponenter/assets/partials/_autoCompleteRow.html",e.focused=!1,e.autocompleteActive=!1,e.ajaxCallActive=!1,e.allowBlur=!0,e.viewport={width:window.innerWidth,height:window.innerHeight},e.breakpoints={xSmall:480,small:768,medium:992,large:1200};var p=function(a,o){a.preventDefault(),a.stopPropagation(),t.selectedSearch=o,e.dropdownOpen=!1,document.getElementById("txtSearch").focus()};e.select=p;var h=function(t){switch(t.keyCode){case 38:t.target.blur(),angular.element(t.target).next().children()[dropdownOptions.length-1].focus();break;case 40:t.target.blur(),angular.element(t.target).next().children()[0].focus();break;default:return}t.preventDefault(),t.stopPropagation()},m=function(t,e){var a;switch(t.keyCode){case 13:return void p(t,dropdownOptions[e]);case 38:var o=angular.element(document.getElementById("search-dropdown"));a=0===e?o.children()[dropdownOptions.length-1]:o.children()[e-1];break;case 40:a=e>=dropdownOptions.length-1?angular.element(document.getElementById("search-dropdown")).children()[0]:angular.element(t.target).next()[0];break;default:return}t.target.blur(),a.focus(),t.preventDefault(),t.stopPropagation()};e.dropdownKeyDown=m,e.buttonDropdownKeyDown=h,e.onSearch=function(e){e&&e.preventDefault(),t.searchQuery.length<3||i.triggerSearch(t.searchQuery).then(l)},e.preventDefault=function(t){switch(t.keyCode){case 13:t.preventDefault();break;case 16:k=!0;break;case 9:e.autoCompleteResult.length>0&&t.preventDefault();break;case 38:case 40:t.preventDefault()}};var f=null;e.autocomplete=function(a){if(!1!==e.focused){if(t.searchQuery.length<3)return e.autoCompleteResult=[],e.autocompleteActive=!1,e.ajaxCallActive=!1,void(v=null);switch(a.keyCode){case 13:null===v?(e.resetAutocomplete(),e.allowBlur=!0,e.onSearch(a)):(e.allowBlur=!1,window.location=e.autoCompleteResult[v-1].list[$-1].url);break;case 16:k=!1;break;case 37:break;case 38:return u(),!1;case 39:break;case 9:k?u():d();break;case 40:return d(),!1;default:return v=null,f&&(n.cancel(f),f=null,console.log("cancel timeout")),void(f=n(function(){e.autocompleteActive=!0,console.log("calling WS"),t.searchQuery.length>0&&(e.ajaxCallActive=!0,i.performSearch(t.searchQuery,[],5,0).then(function(t){console.log(t),s({d:{Results:t}})}))},300))}}};var v=null,$=null,k=!1;e.mouseOver=function(t,a,o){console.log(a),console.log(o),e.allowBlur=t,$=o+1,v=a+1,g()},e.mouseOut=function(t){e.allowBlur=t},e.resetAutocomplete=function(){e.focused=!1,e.autocompleteActive=!1,e.ajaxCallActive=!1,e.autoCompleteResult=[]},e.setFocus=function(t){e.focused=!0,console.log(e.focused),angular.element(t.target).on("blur",function(){n(function(){e.allowBlur&&(e.resetAutocomplete(),console.log(e.focused),angular.element(t.target).on("blur",null))},!0)})},angular.element(document).ready(function(){i.triggerSearch(t.searchQuery)})}])}();var parseLocation=function(t){var e,a,o=t.substring(1).split("&"),n={};for(a in o)""!==o[a]&&(e=o[a].split("="),n[decodeURIComponent(e[0])]=decodeURIComponent(e[1]));return n},baseurl="http://"+window.location.host;$(document).ready(function(){$(".page-wizard .page-wizard-tab").on("click",function(){$(".page-wizard").toggleClass("open")});var t=$("<li class='jose'><ul></ul></li>");$("<p>te</p>").appendTo($(t).find("ul"))}),function(){var t=angular.module("geonorge"),e=searchOption.geonorgeUrl;t.controller("menuTopController",["$scope","$http",function(t,a){function o(e){localStorage.setItem("menuItems",JSON.stringify(e));var a=new Date;a.setTime(a.getTime()+18e4),Cookies.set("expire","menu",{expires:a}),t.menuItems=e.data}function n(){t.getMenuError=!0}t.getMenuData=function(){if(!Cookies.get("expire")||!localStorage.getItem("menuItems")){var i=a({method:"GET",url:e+"/api/menu",headers:{"Content-Type":"application/json; charset=utf-8"},data:{}});return console.log("Menu loaded from server"),i.then(o,n)}console.log("Menu loaded locally"),response=JSON.parse(localStorage.getItem("menuItems")),t.menuItems=response.data}}])}(),$(window).load(function(){updateShoppingCart()}),$("document").ready(function(){updateToggleLinks($(".toggle-content")),$(".toggle-content").click(function(){var t=$(this).data("content-toggle");updateToggleLinks($(this)),$("."+t).toggle()})}),$(".link-tabs").ready(function(){$(".link-tabs li a").click(function(t){t.preventDefault(),activateTab($(this).data("tab")),$("#tab-content").css("opacity",".15"),window.location.href=$(this).prop("href")})}),$("document").ready(function(){$("a.help-text-toggle").click(function(t){t.preventDefault();var e=$(this),a=$(this).data("help-text-id");$("#"+a).toggle(),$("#"+a).hasClass("active")?($("#"+a).removeClass("active"),e.removeClass("active")):($("#"+a).addClass("active"),e.addClass("active"))})}),$("document").ready(function(){$("ul.pagination a, ul.breadcrumbs a").each(function(){$(this).closest("li").hasClass("active")||addDefaultLoadingAnimation($(this))})}),$("document").ready(function(){$("body").on("click","a",function(){notCurrentUrl($(this).attr("href"))&&$(this).removeClass("show-loading-animation")})}),$("document").ready(function(){disableLastBreadcrumb()}),$(document).on("focus",".custom-select-list-input",function(){var t=$(this).closest(".custom-select-list").find(".custom-select-list-dropdown");t.addClass("active"),t.removeClass("transparent")}),$(document).on("blur",".custom-select-list-input",function(){var t=this,e=$(this).closest(".custom-select-list").find(".custom-select-list-dropdown");e.addClass("transparent"),setTimeout(function(){t!==document.activeElement&&(e.removeClass("active"),e.removeClass("transparent"))},1e3)}),$(document).on("click",".custom-select-list-input-container",function(){$(this).find(".custom-select-list-input").focus()});